module AeronTensorPool

using Aeron
using Agent
using Clocks
using FixedSizeArrays
using Hsm
using Mmap
using SBE
using StringViews
using UnsafeArrays
using UUIDs

include("gen/ShmTensorpoolControl.jl")
using .ShmTensorpoolControl
include("gen/ShmTensorpoolDriver.jl")
using .ShmTensorpoolDriver
include("gen/ShmTensorpoolBridge.jl")
using .ShmTensorpoolBridge
include("gen/ShmTensorpoolDiscovery.jl")
using .ShmTensorpoolDiscovery
include("gen/ShmTensorpoolMerge.jl")
using .ShmTensorpoolMerge
include("gen/ShmTensorpoolTraceLink.jl")
using .ShmTensorpoolTraceLink

include("timers/Timers.jl")
include("core/Core.jl")
include("aeron/AeronUtils.jl")
include("shm/Shm.jl")
include("control/Control.jl")
include("agents/driver/Driver.jl")
include("discovery_client/DiscoveryClient.jl")
include("agents/Agents.jl")
include("client/Client.jl")
include("apps/Apps.jl")

using .Core
using .Core.TPLog
using .Agents
using .Agents.RateLimiter
using .Agents.JoinBarrier
using .Timers
using .Shm
using .AeronUtils
using .Control
using .Driver
using .DiscoveryClient
using .Client

include("config/defaults.jl")
include("config/paths.jl")

export AeronInitError,
    AttachRequestProxy,
    AttachRequestHandle,
    AttachRejectedError,
    AttachTimeoutError,
    AttachResponse,
    Bridge,
    BridgeAgent,
    BridgeSystemAgent,
    BridgeConfigError,
    BridgeAssembledFrame,
    BridgeConfig,
    load_bridge_config,
    BridgeCounters,
    BridgeCallbacks,
    BridgeMapping,
    BridgeReceiverState,
    BridgeSenderState,
    BridgeSourceInfo,
    Consumer,
    ConsumerAgent,
    ConsumerConfigMsg,
    ConsumerCounters,
    ConsumerFrameView,
    ConsumerHello,
    ConsumerCallbacks,
    ConsumerConnections,
    ConsumerInfo,
    ConsumerConfig,
    ConsumerPhase,
    UNMAPPED,
    MAPPED,
    FALLBACK,
    ConsumerState,
    ConsumerHandle,
    Counters,
    DetachRequestProxy,
    DetachResponse,
    DiscoveryConfigError,
    DiscoveryTimeoutError,
    DiscoveryAgent,
    DiscoveryClientState,
    DiscoveryMessageHeader,
    DiscoveryConfig,
    DiscoveryEntry,
    DiscoveryPoolEntry,
    DiscoveryRegistryConfig,
    DiscoveryRegistry,
    DiscoveryRegistryAgent,
    DiscoveryRegistryEndpoint,
    DiscoveryRequest,
    DiscoveryResponse,
    DiscoveryResultView,
    DiscoveryResponseSlot,
    DiscoveryStatus,
    DiscoveryProviderState,
    DiscoveryRegistryState,
    DriverAgent,
    DriverClientState,
    DriverConfig,
    DriverCounters,
    DriverMetrics,
    DriverStatusSnapshot,
    DriverLeaseSnapshot,
    LeaseLifecycle,
    DriverStreamSnapshot,
    DriverAssignedStreamSnapshot,
    DriverEndpoints,
    DriverHugepagesPolicy,
    DriverLeaseRevokeReason,
    DriverMessageHeader,
    DriverPolicyConfig,
    DriverPool,
    DriverPoolConfig,
    DriverProfileConfig,
    DriverStreamIdRange,
    DriverPublishMode,
    DriverResponseCode,
    DriverResponsePoller,
    AbstractTensorPoolClient,
    client_context,
    aeron_client,
    control_runtime,
    AbstractControlPoller,
    FrameDescriptorPoller,
    ConsumerConfigPoller,
    FrameProgressPoller,
    TraceLinkPoller,
    handle_driver_response!,
    QosMonitor,
    QosProducerSnapshot,
    QosConsumerSnapshot,
    poll_qos!,
    poll!,
    rebind!,
    producer_qos,
    consumer_qos,
    MetadataAttribute,
    MetadataEntry,
    MetadataPublisher,
    MetadataCache,
    emit_metadata_announce!,
    emit_metadata_meta!,
    poll_metadata!,
    metadata_entry,
    announce_data_source!,
    metadata_version,
    set_metadata_attribute!,
    set_metadata_attributes!,
    delete_metadata_attribute!,
    set_metadata!,
    TraceIdGenerator,
    TraceLinkContext,
    TraceLinkPublisher,
    enable_tracing!,
    trace_id_for_output!,
    new_trace_id_from_parents!,
    reuse_trace_id,
    emit_tracelink!,
    emit_tracelink_set!,
    next_trace_id!,
    encode_tracelink_set!,
    decode_tracelink_set!,
    DriverRole,
    DriverShmConfig,
    DriverShutdown,
    DriverShutdownReason,
    DriverState,
    DriverStreamConfig,
    Dtype,
    FixedString,
    FrameDescriptor,
    FrameProgress,
    TraceLinkSet,
    HEADER_SLOT_BYTES,
    KeepaliveProxy,
    LeaseRevoked,
    MAGIC_TPOLSHM1,
    MAX_DIMS,
    MajorOrder,
    MessageHeader,
    Mode,
    TraceLinkMessageHeader,
    PayloadPoolConfig,
    PayloadView,
    TRACELINK_MESSAGE_HEADER_LEN,
    PolledTimer,
    Producer,
    ProducerAgent,
    ProducerConfig,
    ProducerCounters,
    ProducerCallbacks,
    ProducerInfo,
    ProducerConsumerStream,
    ProducerState,
    ProducerHandle,
    ProducerConnections,
    producer_connected,
    producer_connections,
    consumer_connected,
    consumer_connections,
    QosConsumer,
    QosProducer,
    RegionType,
    RateLimiterConfig,
    RateLimiterMapping,
    RateLimiterState,
    RateLimiterAgent,
    load_rate_limiter_config,
    init_rate_limiter,
    rate_limiter_do_work!,
    JoinBarrierMode,
    SEQUENCE,
    TIMESTAMP,
    LATEST_VALUE,
    JoinBarrierConfig,
    JoinBarrierResult,
    JoinBarrierState,
    SequenceMergeRule,
    SequenceMergeMap,
    TimestampMergeRule,
    TimestampMergeMap,
    JoinBarrierCodec,
    MergeMapAuthority,
    join_barrier_ready!,
    sequence_ready!,
    timestamp_ready!,
    latest_value_ready!,
    apply_sequence_merge_map!,
    apply_timestamp_merge_map!,
    set_active_epoch!,
    invalidate_latest!,
    update_observed_seq!,
    update_processed_seq!,
    update_observed_seq_epoch!,
    update_processed_seq_epoch!,
    update_observed_time!,
    update_processed_time!,
    update_observed_time_epoch!,
    update_processed_time_epoch!,
    update_observed_slot_header_time!,
    encode_sequence_merge_map_announce!,
    encode_sequence_merge_map_request!,
    encode_timestamp_merge_map_announce!,
    encode_timestamp_merge_map_request!,
    decode_sequence_merge_map_announce,
    decode_timestamp_merge_map_announce,
    send_sequence_merge_map_request!,
    send_timestamp_merge_map_request!,
    publish_sequence_merge_map!,
    publish_timestamp_merge_map!,
    JoinBarrierAgent,
    SUPERBLOCK_SIZE,
    ShmAttachRequest,
    ShmAttachResponse,
    ShmDetachRequest,
    ShmDetachResponse,
    ShmDriverShutdown,
    ShmDriverShutdownRequest,
    ShmLeaseKeepalive,
    ShmLeaseRevoked,
    ShmRegionSuperblock,
    ShmUri,
    ShmUriError,
    ShmValidationError,
    SlotClaim,
    SuperblockFields,
    Supervisor,
    SupervisorAgent,
    SupervisorConfig,
    SupervisorCounters,
    SupervisorCallbacks,
    SupervisorState,
    TensorPoolClient,
    TensorPoolContext,
    TensorPoolRuntime,
    TensorPoolError,
    ProtocolError,
    ShmError,
    AeronError,
    SlotHeader,
    TensorHeader,
    SlotHeaderMsg,
    TensorHeaderMsg,
    TimerSet,
    add_counter,
    attach,
    connect,
    with_runtime,
    handle_agent,
    handle_state,
    apply_consumer_config!,
    canonical_epoch_dir,
    canonical_header_uri,
    canonical_pool_uri,
    canonical_shm_paths,
    do_work,
    driver_client_do_work!,
    driver_do_work!,
    discovery_result_view,
    discover_streams!,
    due!,
    header_commit_ptr,
    header_commit_ptr_from_offset,
    header_slot_offset,
    init_discovery_client,
    init_driver,
    init_driver_client,
    load_driver_config,
    from_toml,
    default_consumer_config,
    default_producer_config,
    make_counter_type_id,
    mmap_shm,
    mmap_shm_existing,
    shm_available_bytes,
    next_header_index,
    parse_shm_uri,
    shm_path,
    payload_slot_offset,
    payload_slot_ptr,
    payload_slot_view,
    try_payload_slot_view,
    poll_attach!,
    poll_driver_control!,
    poll_driver_responses!,
    poll_discovery_response!,
    poll!,
    read_superblock,
    read_slot_header,
    refresh_activity_timestamps!,
    reset!,
    sbe_message_length,
    send_attach!,
    send_attach_request!,
    request_attach,
    send_detach!,
    snapshot_attach_response!,
    snapshot_detach_response!,
    snapshot_lease_revoked!,
    snapshot_shutdown!,
    send_discovery_request!,
    send_keepalive!,
    seqlock_begin_write!,
    seqlock_commit_write!,
    seqlock_is_committed,
    seqlock_sequence,
    seqlock_read_begin,
    seqlock_read_end,
    with_claimed_buffer!,
    validate_discovery_endpoints,
    validate_superblock_fields,
    validate_uri,
    register_driver!,
    unregister_driver!,
    find_driver_state,
    list_driver_instances,
    driver_status_snapshot,
    driver_leases_snapshot,
    driver_streams_snapshot,
    driver_assigned_streams_snapshot,
    emit_driver_shutdown!,
    driver_lifecycle_dispatch!,
    revoke_lease!,
    wrap_superblock!,
    wrap_slot_header!,
    write_superblock!,
    write_slot_header!

end
