using Test
using AeronTensorPool

include("helpers_aeron.jl")
include("helpers_external.jl")

include("test_shm_uri.jl")
include("test_shm_superblock.jl")
include("test_tensor_slot_header.jl")
include("test_slot_header_zero_fill.jl")
include("test_consumer_validation.jl")
include("test_consumer_pid_change.jl")
include("test_consumer_path_containment.jl")
include("test_consumer_remap_fallback.jl")
include("test_consumer_fallback_uri_validation.jl")
include("test_consumer_seq_gap.jl")
include("test_consumer_rate_limited.jl")
include("test_consumer_stride_validation.jl")
include("test_consumer_stride_validation_fuzz.jl")
include("test_consumer_seqlock.jl")
include("test_consumer_tensor_header_validation.jl")
include("test_sbe_var_data_bounds_fuzz.jl")
include("test_descriptor_progress_decode_fuzz.jl")
include("test_consumer_ndims_range.jl")
include("test_consumer_invalid_header_enums.jl")
include("test_consumer_phase.jl")
include("test_consumer_epoch_preference.jl")
include("test_consumer_join_time.jl")
include("test_consumer_activity_freshness.jl")
include("test_consumer_announce_timeout_backoff.jl")
include("test_consumer_announce_stream.jl")
include("test_consumer_revoke_stream_match.jl")
include("test_consumer_superblock_validation.jl")
include("test_consumer_payload_len_exceeds_stride.jl")
include("test_consumer_payload_slot_out_of_range.jl")
include("test_timebase_clock.jl")
include("test_seqlock_encoding.jl")
include("test_consumer_schema_gating.jl")
include("test_consumer_attach_response_validation.jl")
include("test_consumer_progress_validation.jl")
include("test_consumer_empty_payload.jl")
include("test_consumer_payload_offset_invalid.jl")
include("test_consumer_payload_slot_mismatch.jl")
include("test_consumer_header_payload_fuzz.jl")
include("test_producer_progress_hints.jl")
include("test_producer_progress_emit.jl")
include("test_allocations.jl")
include("test_allocations_load.jl")
include("test_allocations_seqlock.jl")
include("test_allocations_shm_uri.jl")
include("test_allocations_driver_control.jl")
include("test_allocations_driver_poller.jl")
include("test_allocations_loop.jl")
include("test_allocations_qos_monitor.jl")
include("test_counters.jl")
include("test_polled_timer.jl")
include("test_discovery_filters.jl")
include("test_discovery_expiry.jl")
include("test_discovery_integration.jl")
include("test_discovery_multihost.jl")
include("test_discovery_end_to_end.jl")
include("test_discovery_validation.jl")
include("test_discovery_schema_gating.jl")
include("test_discovery_response_rules.jl")
include("test_discovery_response_limits.jl")
include("test_aeron_integration.jl")
include("test_supervisor_integration.jl")
include("test_supervisor_liveness.jl")
include("test_qos_monitor_integration.jl")
include("test_metadata_helpers.jl")
include("test_metadata_chunks.jl")
include("test_metadata_api.jl")
include("test_callbacks_metadata_qos.jl")
include("test_tracelink.jl")
include("test_allocations_tracelink.jl")
include("test_payload_slot.jl")
include("test_pool_selection.jl")
include("test_slot_claim.jl")
include("test_cli_tool.jl")
include("test_driver_config.jl")
include("test_config_defaults.jl")
include("test_driver_attach.jl")
include("test_driver_attach_existing_or_create.jl")
include("test_driver_node_id_stability.jl")
include("test_driver_desired_node_id.jl")
include("test_driver_expected_layout_version.jl")
include("test_driver_attach_remap.jl")
include("test_driver_attach_required_fields.jl")
include("test_driver_per_consumer_streams.jl")
include("test_driver_shutdown.jl")
include("test_driver_shutdown_timer.jl")
include("test_driver_shutdown_request.jl")
include("test_driver_integration.jl")
include("test_driver_reattach.jl")
include("test_driver_cleanup_shm.jl")
include("test_driver_reuse_existing_shm.jl")
include("test_driver_restart_epoch.jl")
include("test_driver_lease_expiry.jl")
include("test_driver_revoke_idempotent.jl")
include("test_driver_shm_permissions.jl")
include("test_driver_lease_hsm.jl")
include("test_driver_response_overflow.jl")
include("test_driver_control_schema_gating.jl")
include("test_driver_control_ignore_responses.jl")
include("test_driver_control_var_data_fuzz.jl")
include("test_integration_attach_correlation.jl")
include("test_driver_client_correlation_rules.jl")
include("test_driver_epoch_gc_activity.jl")
include("test_integration_consumer_callbacks.jl")
include("test_callbacks_metadata_qos.jl")
include("test_attach_retry.jl")
include("test_attach_backoff.jl")
include("test_attach_burst.jl")
include("test_client_id_auto_assign.jl")
include("test_control_plane_gating.jl")
include("test_control_schema_gating.jl")
include("test_control_descriptor_pollers.jl")
include("test_driver_lease_expiry_slow_client.jl")
include("test_system_external_flow.jl")
include("test_integration_app_flow.jl")
include("test_per_consumer_streams.jl")
include("test_per_consumer_rate_hz.jl")
include("test_bridge_integration.jl")
include("test_bridge_config_validation.jl")
include("test_bridge_progress_mapping.jl")
include("test_bridge_qos_forwarding.jl")
include("test_bridge_publish_ordering.jl")
include("test_bridge_header_validation.jl")
include("test_bridge_chunk_validation.jl")
include("test_bridge_chunk_fuzz.jl")
include("test_bridge_max_payload_bytes.jl")
include("test_bridge_integrity.jl")
include("test_bridge_assembly_timeout.jl")
include("test_bridge_backpressure.jl")
include("test_bridge_tracelink_chunks.jl")
include("test_allocations_bridge.jl")
include("test_allocations_join_barrier.jl")
include("test_allocations_claim_path.jl")
include("test_bridge_discovery_integration.jl")
include("test_full_stack_driver_mode.jl")
include("test_client_api.jl")
include("test_client_interface_contract.jl")
include("test_producer_descriptor_headless.jl")
include("test_rate_limiter_end_to_end.jl")
include("test_rate_limiter_forwarding.jl")
include("test_rate_limiter_config_validation.jl")
include("test_join_barrier_sequence.jl")
include("test_join_barrier_timestamp.jl")
include("test_join_barrier_latest.jl")
include("test_join_barrier_codec.jl")
include("test_join_barrier_validation_fuzz.jl")
include("test_join_barrier_examples.jl")
if get(ENV, "TP_RUN_SYSTEM_SMOKE", "false") == "true"
    include("test_system_smoke.jl")
end
if get(ENV, "TP_RUN_SYSTEM_SMOKE_GC", "false") == "true"
    include("test_system_smoke_gc.jl")
end
